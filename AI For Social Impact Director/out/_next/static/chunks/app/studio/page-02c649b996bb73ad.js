(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[348],{9212:function(e,t,s){Promise.resolve().then(s.bind(s,5018))},5018:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var r=s(7437),a=s(2265),i=s(9376),n=s(429),l=s(5095),o=s(7648),c=s(8495);function d(){let[e,t]=(0,a.useState)(""),[s,d]=(0,a.useState)(!1),[u,h]=(0,a.useState)(0),[m,p]=(0,a.useState)(""),[g,f]=(0,a.useState)(!1),x=(0,i.useRouter)(),b=(0,a.useMemo)(()=>(function(e){if(!e||0===e.trim().length)return{score:100,flags:[],suggestions:["Start writing your story to see feedback!"]};let t=e.trim().split(/\s+/).filter(e=>e.length>0),s=t.length;e.length;let r=e.split(/[.!?]+/).filter(e=>e.trim().length>0),a=100,i=[],n=[];s<80?(a-=20,i.push("Short script"),n.push("Your story is ".concat(s," words. Try to write at least 80 words with more details, characters, and actions."))):s<150&&(a-=10,n.push("Great start! Adding more details will make your story even better."));let l=0;[/\bin today's world\b/gi,/\bit is important to\b/gi,/\bin conclusion\b/gi,/\bmoreover\b/gi,/\bfurthermore\b/gi,/\badditionally\b/gi,/\bit should be noted that\b/gi,/\bas previously mentioned\b/gi,/\bin summary\b/gi,/\bto sum up\b/gi,/\bit is crucial\b/gi,/\bit is essential\b/gi,/\bwithout a doubt\b/gi,/\bit goes without saying\b/gi].forEach(t=>{let s=e.match(t);s&&(l+=s.length)}),l>0&&(a-=3*l,i.push("Generic phrases detected"),n.push('Avoid phrases like "in today\'s world" or "it is important to". Use your own words and be specific!'));let o=e.match(/\b(I|we|my|our|me|us|myself|ourselves)\b/gi);!(o&&o.length>0)&&s>50&&(a-=15,i.push("Missing personal voice"),n.push('Add personal touches! Use "I", "we", "my", or "our" to make it feel like YOUR story.'));let c=/\d+/.test(e),d=/\b(in|at|on|near|by|from|to)\s+[A-Z][a-z]+/.test(e)||/\b(city|town|village|country|place|home|school|park|river|ocean|forest)\b/gi.test(e),u=/\b(run|walk|jump|climb|build|create|make|help|save|clean|plant|grow|learn|teach|share|work|play|sing|dance|write|read|draw|paint)\b/gi.test(e),h=0;c&&h++,d&&h++,u&&h++,h<2&&s>50&&(a-=10,i.push("Needs more specifics"),n.push('Add specific details: numbers ("10 trees"), locations ("in the park"), and actions ("planted seeds").'));let m=0;[/\bas an ai\b/gi,/\blanguage model\b/gi,/\bchatgpt\b/gi,/\bopenai\b/gi,/\bassistant\b/gi,/\bI cannot\b/gi,/\bI don't have\b/gi].forEach(t=>{t.test(e)&&m++}),m>0&&(a-=30,i.push("AI-like phrases detected"),n.push("Remove phrases that sound like AI responses. Write in your own voice!"));let p=e.split(/\n\s*\n/).filter(e=>e.trim().length>0);return(p.length>0?p.reduce((e,t)=>e+t.length,0)/p.length:e.length)>500&&p.length<3&&(a-=10,i.push("Long paragraphs"),n.push("Break up long paragraphs! Shorter paragraphs with line breaks make stories easier to read.")),r.length>0&&t.length/r.length>25&&(a-=5,n.push("Mix short and long sentences for better flow!")),!/\b(happy|sad|excited|worried|proud|scared|brave|kind|helpful|grateful|hopeful|determined|inspired|joyful|peaceful|angry|frustrated|calm|nervous|confident)\b/gi.test(e)&&s>80&&(a-=5,n.push("Add emotions! How do your characters feel? (happy, worried, proud, etc.)")),(a=Math.max(0,Math.min(100,a)))>=80?n.unshift("Great job! Your story has a strong personal voice."):a>=60&&n.unshift("Good start! A few improvements will make it even better."),{score:Math.round(a),flags:i,suggestions:n.slice(0,5)}})(e),[e]);(0,a.useEffect)(()=>{let e=localStorage.getItem("studioScript"),s=localStorage.getItem("studioIntegrity");e&&t(e),"true"===s&&f(!0)},[]),(0,a.useEffect)(()=>{e&&localStorage.setItem("studioScript",e),localStorage.setItem("studioIntegrity",g.toString())},[e,g]);let y=["Casting characters...","Rendering scene 1...","Rendering scene 2...","Adding subtitles...","Applying colors...","Finalizing animation..."],w=async()=>{try{if(e.trim().length<60){alert("Please write a longer script! At least 60 characters needed. \uD83D\uDCDD");return}if(!g){alert("Please confirm that this story reflects your own ideas before generating. ✍️");return}d(!0),h(0),p(y[0])}catch(e){console.error("Error in handleGenerate setup:",e),d(!1),alert("An error occurred. Please try again.");return}let t=0,s=0,r=null;try{r=setInterval(()=>{try{t=Math.min(t+10*Math.random()+3,90),h(t);let e=Math.floor(t/100*y.length);e!==s&&e<y.length&&(s=e,p(y[s]))}catch(e){console.error("Error in progress interval:",e)}},300)}catch(e){console.error("Error setting up progress interval:",e),r&&clearInterval(r)}try{let t;let s=new AbortController,a=setTimeout(()=>s.abort(),3e4);try{t=await fetch("/api/generate-video",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({script:e}),signal:s.signal}),clearTimeout(a)}catch(e){if(clearTimeout(a),"AbortError"===e.name)throw Error("Request timeout - API call took too long");throw e}if(clearInterval(r),h(100),p("Finalizing animation..."),!t.ok){if(404===t.status)throw Error("STATIC_EXPORT_MODE");let e=await t.json().catch(()=>({}));throw Error(e.error||"Failed to generate video")}let i=await t.json();console.log("API Response:",i),sessionStorage.setItem("userScript",e),sessionStorage.setItem("videoData",JSON.stringify(i)),sessionStorage.removeItem("errorMessage"),setTimeout(()=>{d(!1),x.push("/result")},500)}catch(t){try{r&&clearInterval(r)}catch(e){console.error("Error clearing interval:",e)}if(console.error("Error generating video:",t),"STATIC_EXPORT_MODE"===t.message||t.message.includes("Failed to fetch")||t.message.includes("404")||"TypeError"===t.name){let t={id:"video_".concat(Date.now()),status:"saved",script:e,storyboard:{title:e.split("\n")[0]||"SDG Animation",summary:e.substring(0,200),scenes:[{sceneNumber:1,description:e.substring(0,300),duration:120,visualStyle:"2D animation with bright colors"}]},scenes:[],model:"luma-dream-machine",created_at:new Date().toISOString(),video_url:null,generation_id:null};h(100),setTimeout(()=>{d(!1),sessionStorage.setItem("userScript",e),sessionStorage.setItem("videoData",JSON.stringify(t)),sessionStorage.setItem("errorMessage","Your story has been saved successfully! Video generation requires server-side functionality. Your script is ready for review."),x.push("/result")},500)}else h(100),setTimeout(()=>{d(!1);let s=t.message||"Video generation is in progress or failed. Your story has been saved!";sessionStorage.setItem("userScript",e),sessionStorage.setItem("errorMessage",s),sessionStorage.setItem("videoData",JSON.stringify({status:"error",script:e,error:s,details:t.message})),x.push("/result")},500)}};return(0,r.jsxs)("div",{className:"min-h-screen relative overflow-hidden",children:[(0,r.jsx)("div",{className:"absolute inset-0 opacity-10 pointer-events-none",children:(0,r.jsx)("div",{className:"grid grid-cols-8 gap-4 p-8 text-4xl",children:Array.from({length:100}).map((e,t)=>(0,r.jsx)(n.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.01*t,duration:.5},className:"text-center",children:t%2==0?"\uD83D\uDCF7":"\uD83C\uDFA5"},t))})}),(0,r.jsxs)("div",{className:"relative z-10 container mx-auto px-4 py-8 max-w-6xl",children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-8",children:(0,r.jsx)(o.default,{href:"/",children:(0,r.jsx)(n.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"text-gray-600 hover:text-gray-800 font-semibold flex items-center gap-2",children:"← Back to Home"})})}),(0,r.jsx)(n.E.h1,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-4xl md:text-5xl font-bold text-center mb-8 bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Script Studio \uD83C\uDFAC"}),(0,r.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[(0,r.jsx)("div",{className:"md:col-span-2",children:(0,r.jsxs)(n.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-lg p-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4 text-gray-800",children:"Your Script"}),(0,r.jsx)("textarea",{value:e,onChange:e=>t(e.target.value),placeholder:"Write your story here...\n\nExample:\nOnce upon a time, in a small coastal village, the ocean was filled with plastic waste. Maria, a young student, noticed that sea turtles were getting sick. She decided to organize a beach cleanup with her friends. Together, they collected hundreds of plastic bottles and created art from them. The whole village joined in, and soon the ocean was clean again. The sea turtles returned, and Maria learned that one person can make a big difference.\n\nYour story should include:\n• A clear SDG theme (like clean oceans, climate action, or ending poverty)\n• Characters that students can relate to\n• A problem that needs solving\n• An inspiring solution or message\n• A setting that brings the story to life\n• A hopeful ending\n\nWrite your story below:",className:"w-full h-96 p-4 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none resize-none text-gray-700 font-sans leading-relaxed"}),e.length>0&&(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)(c.Z,{score:b.score,flags:b.flags,suggestions:b.suggestions})}),(0,r.jsx)("div",{className:"mt-4 p-4 bg-blue-50 border-2 border-blue-200 rounded-lg",children:(0,r.jsxs)("label",{className:"flex items-start gap-3 cursor-pointer",children:[(0,r.jsx)("input",{type:"checkbox",checked:g,onChange:e=>f(e.target.checked),className:"mt-1 w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,r.jsxs)("span",{className:"text-sm text-gray-700",children:[(0,r.jsx)("strong",{children:"I confirm this story reflects my own ideas"})," (AI can help, but I directed it)."]})]})}),(0,r.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:[e.length," characters"]}),(0,r.jsx)(n.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:w,disabled:s||!g,className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:shadow-xl transition-shadow disabled:opacity-50 disabled:cursor-not-allowed",children:s?"Generating...":"Generate Animation ✨"})]})]})}),(0,r.jsx)("div",{className:"md:col-span-1",children:(0,r.jsxs)(n.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3},className:"bg-gradient-to-br from-purple-100 to-pink-100 rounded-xl shadow-lg p-6 h-full",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4 text-gray-800",children:"Storytelling Tips \uD83D\uDCA1"}),(0,r.jsxs)("ul",{className:"space-y-3 text-gray-700",children:[(0,r.jsxs)("li",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"mr-2",children:"\uD83D\uDCD6"}),(0,r.jsxs)("span",{children:[(0,r.jsx)("strong",{children:"Create characters"})," with names and personalities"]})]}),(0,r.jsxs)("li",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"mr-2",children:"\uD83C\uDF0D"}),(0,r.jsxs)("span",{children:[(0,r.jsx)("strong",{children:"Set the scene"})," - where does your story happen?"]})]}),(0,r.jsxs)("li",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"mr-2",children:"⚡"}),(0,r.jsxs)("span",{children:[(0,r.jsx)("strong",{children:"Show the problem"})," - what needs to be fixed?"]})]}),(0,r.jsxs)("li",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"mr-2",children:"\uD83D\uDCAA"}),(0,r.jsxs)("span",{children:[(0,r.jsx)("strong",{children:"Describe the action"})," - what do characters do?"]})]}),(0,r.jsxs)("li",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"mr-2",children:"❤️"}),(0,r.jsxs)("span",{children:[(0,r.jsx)("strong",{children:"Add emotions"})," - how do people feel?"]})]}),(0,r.jsxs)("li",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"mr-2",children:"✨"}),(0,r.jsxs)("span",{children:[(0,r.jsx)("strong",{children:"End with hope"})," - show positive change"]})]}),(0,r.jsxs)("li",{className:"flex items-start",children:[(0,r.jsx)("span",{className:"mr-2",children:"\uD83C\uDFAF"}),(0,r.jsxs)("span",{children:[(0,r.jsx)("strong",{children:"Connect to SDGs"})," - which goal does it address?"]})]})]}),(0,r.jsxs)("div",{className:"mt-6 p-4 bg-white rounded-lg",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:(0,r.jsx)("strong",{children:"Storytelling Tips:"})}),(0,r.jsxs)("ul",{className:"text-xs text-gray-600 space-y-1",children:[(0,r.jsx)("li",{children:'• Start with "Once upon a time..." or "In a world where..."'}),(0,r.jsx)("li",{children:"• Give your characters names"}),(0,r.jsx)("li",{children:"• Describe what they see, feel, and do"}),(0,r.jsx)("li",{children:"• Show the problem clearly"}),(0,r.jsx)("li",{children:"• End with hope and action"})]})]})]})})]})]}),(0,r.jsx)(l.M,{children:s&&(0,r.jsx)(n.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:(0,r.jsxs)(n.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-white rounded-xl p-8 max-w-md w-full mx-4",children:[(0,r.jsx)("h3",{className:"text-2xl font-bold mb-4 text-center text-gray-800",children:"AI Generating..."}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded-full overflow-hidden",children:(0,r.jsx)(n.E.div,{className:"h-full bg-gradient-to-r from-purple-600 to-pink-600",initial:{width:0},animate:{width:"".concat(u,"%")},transition:{duration:.3}})}),(0,r.jsxs)("p",{className:"text-center mt-2 text-gray-600",children:[Math.round(u),"%"]})]}),(0,r.jsx)(n.E.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-center text-lg text-gray-700",children:m},m)]})})})]})}},8495:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var r=s(7437),a=s(429);function i(e){let{score:t,flags:s,suggestions:i}=e,n=e=>e>=80?"from-green-500 to-emerald-500":e>=60?"from-yellow-500 to-orange-500":"from-orange-500 to-red-500";return(0,r.jsxs)(a.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white/90 backdrop-blur-sm rounded-lg p-4 border-2 border-purple-200 shadow-md",children:[(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-gray-800",children:"Human Voice Score"}),(0,r.jsxs)("span",{className:"text-2xl font-bold bg-gradient-to-r ".concat(n(t)," bg-clip-text text-transparent"),children:[t,"/100"]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:(0,r.jsx)(a.E.div,{initial:{width:0},animate:{width:"".concat(t,"%")},transition:{duration:.5,ease:"easeOut"},className:"h-full bg-gradient-to-r ".concat(n(t)," rounded-full")})}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:t>=80?"Excellent":t>=60?"Good":t>=40?"Needs Improvement":"Needs Work"})]}),s.length>0&&(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-1",children:"⚠️ Areas to improve:"}),(0,r.jsx)("ul",{className:"list-disc list-inside text-xs text-gray-600 space-y-1",children:s.map((e,t)=>(0,r.jsx)("li",{children:e},t))})]}),i.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-semibold text-gray-700 mb-1",children:"\uD83D\uDCA1 Tips:"}),(0,r.jsx)("ul",{className:"list-disc list-inside text-xs text-gray-600 space-y-1",children:i.map((e,t)=>(0,r.jsx)("li",{children:e},t))})]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 italic mt-3 pt-3 border-t border-gray-200",children:"\uD83D\uDCAC This is a guide, not a judgment. Use these tips to make your story even better!"})]})}},9376:function(e,t,s){"use strict";var r=s(5475);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},5095:function(e,t,s){"use strict";s.d(t,{M:function(){return f}});var r=s(2265),a=s(1534);function i(){let e=(0,r.useRef)(!1);return(0,a.L)(()=>(e.current=!0,()=>{e.current=!1}),[]),e}var n=s(8345),l=s(4252),o=s(3576);class c extends r.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=t.offsetHeight||0,e.width=t.offsetWidth||0,e.top=t.offsetTop,e.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function d({children:e,isPresent:t}){let s=(0,r.useId)(),a=(0,r.useRef)(null),i=(0,r.useRef)({width:0,height:0,top:0,left:0});return(0,r.useInsertionEffect)(()=>{let{width:e,height:r,top:n,left:l}=i.current;if(t||!a.current||!e||!r)return;a.current.dataset.motionPopId=s;let o=document.createElement("style");return document.head.appendChild(o),o.sheet&&o.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${r}px !important;
            top: ${n}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(o)}},[t]),r.createElement(c,{isPresent:t,childRef:a,sizeRef:i},r.cloneElement(e,{ref:a}))}let u=({children:e,initial:t,isPresent:s,onExitComplete:a,custom:i,presenceAffectsLayout:n,mode:c})=>{let u=(0,o.h)(h),m=(0,r.useId)(),p=(0,r.useMemo)(()=>({id:m,initial:t,isPresent:s,custom:i,onExitComplete:e=>{for(let t of(u.set(e,!0),u.values()))if(!t)return;a&&a()},register:e=>(u.set(e,!1),()=>u.delete(e))}),n?void 0:[s]);return(0,r.useMemo)(()=>{u.forEach((e,t)=>u.set(t,!1))},[s]),r.useEffect(()=>{s||u.size||!a||a()},[s]),"popLayout"===c&&(e=r.createElement(d,{isPresent:s},e)),r.createElement(l.O.Provider,{value:p},e)};function h(){return new Map}var m=s(8881),p=s(3223);let g=e=>e.key||"",f=({children:e,custom:t,initial:s=!0,onExitComplete:l,exitBeforeEnter:o,presenceAffectsLayout:c=!0,mode:d="sync"})=>{var h;(0,p.k)(!o,"Replace exitBeforeEnter with mode='wait'");let f=(0,r.useContext)(m.p).forceRender||function(){let e=i(),[t,s]=(0,r.useState)(0),a=(0,r.useCallback)(()=>{e.current&&s(t+1)},[t]);return[(0,r.useCallback)(()=>n.Wi.postRender(a),[a]),t]}()[0],x=i(),b=function(e){let t=[];return r.Children.forEach(e,e=>{(0,r.isValidElement)(e)&&t.push(e)}),t}(e),y=b,w=(0,r.useRef)(new Map).current,j=(0,r.useRef)(y),v=(0,r.useRef)(new Map).current,N=(0,r.useRef)(!0);if((0,a.L)(()=>{N.current=!1,function(e,t){e.forEach(e=>{let s=g(e);t.set(s,e)})}(b,v),j.current=y}),h=()=>{N.current=!0,v.clear(),w.clear()},(0,r.useEffect)(()=>()=>h(),[]),N.current)return r.createElement(r.Fragment,null,y.map(e=>r.createElement(u,{key:g(e),isPresent:!0,initial:!!s&&void 0,presenceAffectsLayout:c,mode:d},e)));y=[...y];let E=j.current.map(g),S=b.map(g),k=E.length;for(let e=0;e<k;e++){let t=E[e];-1!==S.indexOf(t)||w.has(t)||w.set(t,void 0)}return"wait"===d&&w.size&&(y=[]),w.forEach((e,s)=>{if(-1!==S.indexOf(s))return;let a=v.get(s);if(!a)return;let i=E.indexOf(s),n=e;n||(n=r.createElement(u,{key:g(a),isPresent:!1,onExitComplete:()=>{w.delete(s);let e=Array.from(v.keys()).filter(e=>!S.includes(e));if(e.forEach(e=>v.delete(e)),j.current=b.filter(t=>{let r=g(t);return r===s||e.includes(r)}),!w.size){if(!1===x.current)return;f(),l&&l()}},custom:t,presenceAffectsLayout:c,mode:d},a),w.set(s,n)),y.splice(i,0,n)}),y=y.map(e=>{let t=e.key;return w.has(t)?e:r.createElement(u,{key:g(e),isPresent:!0,presenceAffectsLayout:c,mode:d},e)}),r.createElement(r.Fragment,null,w.size?y:y.map(e=>(0,r.cloneElement)(e)))}}},function(e){e.O(0,[507,971,117,744],function(){return e(e.s=9212)}),_N_E=e.O()}]);